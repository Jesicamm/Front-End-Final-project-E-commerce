{"ast":null,"code":"var _jsxFileName = \"/home/jessica/PROYECTOS GEEKSHUBS/PROYECTOS/proyecto final front/Front-End-Final-project-E-commerce/finalproject/src/views/Store/Store.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport Header from '../../components/Header/Header';\nimport { useHistory } from 'react-router-dom';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Store = props => {\n  _s();\n\n  const [rentFilm, setRentFilm] = useState(true);\n  let link = 'https://image.tmdb.org/t/p/original';\n  let dataMovie = JSON.parse(localStorage.getItem('movie'));\n  const [trailer, setTrailer] = useState(\"\");\n  const [realizado, setRealizado] = useState('');\n  const [order, setOrder] = useState({\n    orderID: '',\n    titeMovie: '',\n    client: props.user.name,\n    initialRentDate: '',\n    returnRentDate: '',\n    poster: '',\n    payment: true\n  }); // Getting trailer link\n\n  const getTrailer = async () => {\n    var _keyLink$data$results;\n\n    let apiKey = \"ef2edc9da61e81787a8079a7df721936\";\n    let base_url = `http://api.themoviedb.org/3/movie/`;\n    let movieId = dataMovie.id;\n    let keyLink = await axios.get(`${base_url}${movieId}/videos?api_key=${apiKey}`);\n    let trailerKey = (_keyLink$data$results = keyLink.data.results[0]) === null || _keyLink$data$results === void 0 ? void 0 : _keyLink$data$results.key;\n    return setTrailer(`https://www.youtube.com/watch?v=${trailerKey}`);\n  };\n\n  let history = useHistory();\n\n  const goto = () => {\n    setTimeout(() => {\n      history.push('/home');\n    }, 1000);\n  }; // //USEEFFECTS\n\n\n  useEffect(() => {\n    getTrailer();\n  }, []); //Alquilar un pelicula//\n\n  const Alquilar = async () => {\n    let endPointRent = `http://localhost:3002/users/${props.user.userId}/orders`; //Datos de lel alquiler , Id del usuario , id de la pelicula y el  objeto completo de la pelicula//\n\n    let rentData = {\n      userId: props.user._id,\n      filmTitle: dataMovie.title,\n      film: dataMovie.poster_path,\n      poster_path: dataMovie.poster_path,\n      payment: true\n    };\n    let response = await axios.post(endPointRent, rentData);\n    localStorage.setItem('rentInfo', JSON.stringify(response));\n    let orderResponse = response.data.order;\n    let objectRent = {\n      orderID: orderResponse._id,\n      client: props.user.name,\n      initialRentDate: orderResponse.order_date,\n      returnRentDate: orderResponse.return_date,\n      payment: true\n    };\n    setOrder(objectRent);\n    setRentFilm(false);\n\n    if (order.payment === true) {\n      return setRealizado('Pago Realizado Mediante Tarjeta');\n    }\n  };\n\n  let NotRented = /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"rent\",\n    onClick: () => Alquilar(),\n    children: [\"Alquilar \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 78\n    }, this), \"4.99\\u20AC\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 20\n  }, this);\n\n  let Rented = /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"rent\",\n    children: [\"Estas Viendo \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 53\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 17\n  }, this);\n\n  if (!props.token) {\n    setTimeout(() => {\n      history.push('/');\n    }, 2000);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-gif\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"gif\",\n        children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 16\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 10\n    }, this);\n  }\n\n  ;\n\n  if (rentFilm === false) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"store-container\",\n      children: /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 10\n    }, this);\n  }\n};\n\n_s(Store, \"z9yV9VZGGA5AFpjJoJbkeU5E5zo=\", false, function () {\n  return [useHistory];\n});\n\n_c = Store;\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user,\n    token: state.token\n  };\n};\n\nexport default connect(mapStateToProps)(Store);\n\nvar _c;\n\n$RefreshReg$(_c, \"Store\");","map":{"version":3,"sources":["/home/jessica/PROYECTOS GEEKSHUBS/PROYECTOS/proyecto final front/Front-End-Final-project-E-commerce/finalproject/src/views/Store/Store.jsx"],"names":["React","useEffect","useState","Header","useHistory","axios","connect","Store","props","rentFilm","setRentFilm","link","dataMovie","JSON","parse","localStorage","getItem","trailer","setTrailer","realizado","setRealizado","order","setOrder","orderID","titeMovie","client","user","name","initialRentDate","returnRentDate","poster","payment","getTrailer","apiKey","base_url","movieId","id","keyLink","get","trailerKey","data","results","key","history","goto","setTimeout","push","Alquilar","endPointRent","userId","rentData","_id","filmTitle","title","film","poster_path","response","post","setItem","stringify","orderResponse","objectRent","order_date","return_date","NotRented","Rented","token","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Header from '../../components/Header/Header';\nimport { useHistory } from 'react-router-dom';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\n\n\n\nconst Store = (props) => {\n   const [rentFilm, setRentFilm] = useState(true)\n\n   let link = 'https://image.tmdb.org/t/p/original';\n   let dataMovie = JSON.parse(localStorage.getItem('movie'));\n\n   const [trailer, setTrailer] = useState(\"\");\n   const [realizado, setRealizado] = useState('');\n   const [order, setOrder] = useState({\n      orderID: '',\n      titeMovie: '',\n      client: props.user.name,\n      initialRentDate: '',\n      returnRentDate: '',\n      poster: '',\n      payment: true\n\n   })\n\n   // Getting trailer link\n\n   const getTrailer = async () => {\n      let apiKey = \"ef2edc9da61e81787a8079a7df721936\";\n      let base_url = `http://api.themoviedb.org/3/movie/`;\n      let movieId = dataMovie.id;\n      let keyLink = await axios.get(`${base_url}${movieId}/videos?api_key=${apiKey}`);\n      let trailerKey = keyLink.data.results[0]?.key;\n\n      return setTrailer(`https://www.youtube.com/watch?v=${trailerKey}`);\n   };\n\n   let history = useHistory();\n   const goto = () => {\n      setTimeout(() => {\n         history.push('/home')\n      }, 1000);\n   };\n\n   // //USEEFFECTS\n   useEffect(() => {\n      getTrailer()\n   }, []);\n\n\n   //Alquilar un pelicula//\n   const Alquilar = async () => {\n\n      let endPointRent = `http://localhost:3002/users/${props.user.userId}/orders`;\n\n      //Datos de lel alquiler , Id del usuario , id de la pelicula y el  objeto completo de la pelicula//\n      let rentData = {\n         userId: props.user._id,\n         filmTitle: dataMovie.title,\n         film: dataMovie.poster_path,\n         poster_path: dataMovie.poster_path,\n         payment: true,\n\n      };\n\n      let response = await axios.post(endPointRent, rentData);\n      localStorage.setItem('rentInfo', JSON.stringify(response))\n      let orderResponse = response.data.order;\n\n      let objectRent = {\n         orderID: orderResponse._id,\n         client: props.user.name,\n         initialRentDate: orderResponse.order_date,\n         returnRentDate: orderResponse.return_date,\n         payment: true\n      }\n      setOrder(objectRent);\n      setRentFilm(false)\n\n      if (order.payment === true) {\n         return setRealizado('Pago Realizado Mediante Tarjeta');\n      }\n   }\n\n   let NotRented = <div className=\"rent\" onClick={() => Alquilar()}>Alquilar <br />4.99€</div>\n   let Rented = <div className=\"rent\" >Estas Viendo <br /></div>\n\n   if (!props.token) {\n      setTimeout(() => {\n         history.push('/');\n      }, 2000);\n\n      return (\n         <div className=\"container-gif\">\n            <div className=\"gif\">\n               <Loading />\n            </div>\n         </div>\n      );\n   };\n\n   if (rentFilm === false) {\n      return (\n         <div className='store-container'>\n            <Header />\n            \n         </div>\n      )\n   }\n};\n\nconst mapStateToProps = state => {\n   return {\n      user: state.user,\n      token: state.token\n   }\n};\n\nexport default connect(mapStateToProps)(Store);"]},"metadata":{},"sourceType":"module"}